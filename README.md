<<<<<<< HEAD
# RAG-система с графовой базой данных

Система для извлечения информации из документов с использованием Retrieval-Augmented Generation (RAG) и графовой базы данных Neo4j.

## Возможности

- Загрузка и обработка документов в форматах PDF, DOCX и TXT
- Семантический поиск с использованием FAISS и BM25
- Извлечение сущностей и отношений с помощью GLiNER
- Хранение графа знаний в Neo4j
- Переранжирование результатов поиска
- Генерация ответов с использованием LLM (Ollama)
- Telegram-бот для взаимодействия с системой

## Требования

- Python 3.9+
- CUDA-совместимая видеокарта (опционально)
- Neo4j
- Ollama

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/rag-system.git
cd rag-system
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Настройте Neo4j:
   - Установите Neo4j (https://neo4j.com/download/)
   - Создайте базу данных с паролем "neo4jneo4j"
   - Запустите сервер Neo4j

4. Настройте Ollama:
   - Установите Ollama (https://ollama.ai/)
   - Загрузите модель qwen2.5vl:7b:
   ```bash
   ollama pull qwen2.5vl:7b
   ```

5. Создайте файл .env с настройками:
```
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=neo4jneo4j
OLLAMA_HOST=http://localhost:11434
```

## Настройка

Отредактируйте файл `settings.yaml` для настройки системы:

- `telegram_bot_token`: токен вашего Telegram-бота
- `rag_config`: настройки системы RAG
  - `docs_path`: путь к директории с документами
  - `faiss_path`: путь для сохранения индекса FAISS
  - `semantic_chunking`: настройки разбиения текста
  - `gliner`: настройки извлечения сущностей
  - `llm`: настройки языковой модели
  - `retrievers`: настройки поисковых компонентов
  - `embeddings`: настройки эмбеддингов

## Использование

### Консольный режим

```bash
python main.py
```

### Telegram-бот

```bash
python bot.py
```

## Структура проекта

- `main.py`: основной код RAG-системы
- `bot.py`: Telegram-бот для взаимодействия с системой
- `settings.yaml`: файл конфигурации
- `docs/`: директория для документов
- `faiss_index/`: директория для хранения индекса FAISS

## Оптимизации

- Параллельная загрузка и обработка документов
- Кэширование результатов извлечения сущностей
- Пакетная обработка для Neo4j
- Эффективное использование GPU для эмбеддингов и ранжирования
- Параллельный поиск в разных источниках данных

## Решение проблем

### Ошибка несоответствия размерностей векторов

Если вы столкнулись с ошибкой `AssertionError: assert d == self.d` при использовании FAISS, это означает, что размерность векторов запроса не соответствует размерности векторов в индексе. Система автоматически пытается решить эту проблему следующими способами:

1. Проверка размерностей при инициализации
2. Автоматическое пересоздание индекса при обнаружении несоответствия
3. Обработка ошибок при поиске и повторные попытки

Если проблема сохраняется, вы можете:

1. Удалить директорию с индексом FAISS и запустить систему заново:
```bash
rm -rf faiss_index
python main.py
```

2. Вручную пересоздать индекс с помощью параметра `--recreate-index`:
```bash
python main.py --recreate-index
```

### Проблемы с Neo4j

Если вы видите ошибки, связанные с Neo4j, убедитесь, что:

1. Сервер Neo4j запущен
2. Учетные данные в файле .env корректны
3. У вас достаточно прав для создания и изменения данных в базе

### Проблемы с Ollama

При ошибках, связанных с языковой моделью:

1. Проверьте, что Ollama запущен: `ollama ps`
2. Убедитесь, что модель загружена: `ollama list`
3. При необходимости, загрузите модель заново: `ollama pull qwen2.5vl:7b` 
=======
# Kirovskiy
RAG-System
>>>>>>> 530b949e0f6376f13b2b4dc54e7f867a44b0e965
